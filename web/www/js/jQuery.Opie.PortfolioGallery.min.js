var k="auto",O="filters",P="data-opie-",a=".",H=true,l=false,r="undefined";function debug(b){if(arguments.length>1){console.log(arguments);}else{console.log(b);}}var ___isArray=function(b){if(typeof b==="object"){if(typeof b.length==r){return l;}return H;}return l;},__applyToAll=function(b,c){Array.prototype[b]=c;String.prototype[b]=c;Number.prototype[b]=c;Date.prototype[b]=c;Function.prototype[b]=c;RegExp.prototype[b]=c;Boolean.prototype[b]=c;},__applyTo=function(b,c,d){if(b.match(/,/i)){ex=b.split(/,/i);for(i=0;i<0;i++){__applyTo[ex[i],c,d];}}else{if(b=="Array"){Array.prototype[c]=d;}else if(b=="String"){Array.prototype[c]=d;}else if(b=="Number"){Array.prototype[c]=d;}else if(b=="Date"){Array.prototype[c]=d;}else if(b=="Function"){Array.prototype[c]=d;}else if(b=="RegExp"){Array.prototype[c]=d;}else if(b=="Boolean"){Array.prototype[c]=d;}}};function __isNumeric(b){if(b===null){return l;}if(b===undefined){return l;}if(b==""){return l;}b=b.toString().replace(/,/g,a);if(isNaN(b)==H){return l;}else{return H;}}function __toNumber(b){if(typeof b==r){b=this.valueOf();}if(b==undefined){return l;}b=b.toString().replace(/,/g,a);if(__isNumeric(b)){if(b.match(/\./)){return parseFloat(b);}else{return parseInt(b);}}return 0;}__applyToAll("toNumber",__toNumber);var __toNegative=function(){var b=__toNumber(this.valueOf());if(b<=0){return b;}return b*-1;};__applyToAll("toNegative",__toNegative);if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,'');};}if(!Array.prototype.compare){Array.prototype.compare=function(b){if(!b)return false;if(this.length!=b.length)return false;for(var c=0;c<this.length;c++){if(this[c] instanceof Array&&b[c] instanceof Array){if(!this[c].compare(b[c]))return false;}else if(this[c]!=b[c]){return false;}}return true;};}var __toPositive=function(){var b=__toNumber(this.valueOf());if(b<=0){b=b*(-1);}return b;};__applyToAll("toPositive",__toPositive);Function.prototype.eBind=function(d,e,g){var f=this;return function(){var b=e||arguments;if(g===H){b=Array.prototype.slice.call(arguments,0);b=b.concat(e);}else if(typeof g==='number'&&isFinite(g)){b=Array.prototype.slice.call(arguments,0);var c=[g,0].concat(e);Array.prototype.splice.apply(b,c);}return f.apply(d||window,b);};};Function.prototype.delay=function(b){var c=this,d=Array.prototype.slice.call(arguments,1),e=function(){c.apply(window,d);};window.setTimeout(e,b);return c;};Array.prototype.remove=function(b,c){var d=this.slice((c||b)+1||this.length);this.length=b<0?this.length+b:b;return this.push.apply(this,d);};__toFloat=function(){return parseFloat(this.valueOf());};__applyToAll("toFloat",__toFloat);__toInt=function(){return parseInt(this.valueOf());};__applyToAll("toInt",__toInt);$.support.transition=(function(){var b=document.body||document.documentElement,c=b.style,d=c.transition!==undefined||c.WebkitTransition!==undefined||c.MozTransition!==undefined||c.MsTransition!==undefined||c.OTransition!==undefined;return d;})();jQuery.fn.setData=function(b,c){return jQuery(this).data("opie-"+b,c);};jQuery.fn.getData=function(b){return jQuery(this).data("opie-"+b);};jQuery.fn.setAttr=function(b,c){return jQuery(this).attr(P+b,c);};jQuery.fn.getAttr=function(b){return jQuery(this).attr(P+b);};jQuery.fn.delAttr=function(b){return jQuery(this).removeAttr(P+b);};jQuery.fn.hasFilter=function(b){if(b===l||typeof b==r){return H;}var c=jQuery(this).getData(O);if(typeof c[b]!=r){return H;}return l;};jQuery.fn.parseFilters=function(d){var e=jQuery(this),g={};if(e.getAttr("filter")){var f=e.getAttr("filter").toString().split(",");if(f.length>0){jQuery.each(f,function(b,c){g[c]=true;});}}jQuery(this).setData("filters",g);return e;};jQuery.fn.replaceClass=function(b,c){if(typeof c==r){if(b.toString().indexOf("|")>=0){ex=b.split("|");b=ex[0];c=ex[1];}else{c=b;}}return this.removeClass(b).addClass(c);};jQuery.fn.ok=function(){return (this.size()>0)?H:l;};jQuery.fn.getID=function(){return this.attr("id");};jQuery.fn.ID=function(b){if(typeof b!=r){return this.attr("id",b);}return this.attr("id");};jQuery.fn.reverse=[].reverse;var Is=new function(){this.object=function(b){return String(b)==='[object Object]';};this.defined=function(b){return typeof b!==r;};this.array=function(b){if(typeof b==="object"){if(typeof b.length=="undefined"){return false;}return true;}return false;};this.number=function(b){return typeof b==='number'&&isFinite(b);};this.string=function(b){return typeof b==='string';};this.func=function(b){return typeof b=='function';};this.cssSelector=function(b){if(Is.string(b)){if(b=="#"){return l;}if(b.substr(0,1)=="#"||b.substr(0,1)==a){return H;}}return l;};this.between=function(e,g,f,o){var t=function(b,c,d){if(b>=c&&b<=d){return H;}return l;};if($.isArray(e)){var x=l;if(o=="and"){$.each(e,function(b,c){if(!t(c,g,f)){x=l;return l;}});}else{$.each(e,function(b,c){if(t(c,g,f)){x=H;return l;}});}return x;}else{return t(e,g,f);}return l;};},Utils=new function(){this.clone=function(b){if(b==null||!Is.object(b)){return b;}var c={};for(var d in b){if(b.hasOwnProperty(d)){c[d]=Utils.clone(b[d]);}}return c;};this.defaultValue=function(b,c){c=(!Is.defined(c))?l:c;if(!Is.defined(b)){return c;}return b;};this.roundNumber=function(b,c){var d=Math.round(b*Math.pow(10,c))/Math.pow(10,c);return d;};this.calcNewImageSize=function(b,c,d,e){finalHeight=e;finalWidth=d;var g=l;if(b>c){g="W";}else if(b<c){g="H";}else{g="H";}if(d==k){g="H";}if(e==k){g="W";}if(g=='H'){d=Utils.roundNumber(e*(b/c),0);e=finalHeight;}else if(g=='W'){e=Utils.roundNumber(d*(c/b),0);d=finalWidth;}return {ratio:g,h:e,w:d};};},Opts=function(b,c){this.opts=b;this.jq=c;};Opts.prototype={get:function(b){return this.parse(this.opts[b]);},string:function(b){return this.parse(this.opts[b],H);},number:function(b){return parseFloat(this.get(b));},bool:function(b){var c=this.get(b);if(c=="1"||c===H){return H;}return l;},selector:function(b){return this.jq(this.get(b));},func:function(b){return this.parse(this.opts[b],H,H);},parse:function(b,c,d){if(typeof b==r){return "";}var e=b.valueOf();if(typeof e=="function"){if(d==H){return e;}return e();}else if(Is.cssSelector(e)&&c!==H){var g=this.jq(e),f=(g.get(0).tagName=="INPUT"&&g.attr("type").toString().toLowerCase()=="checkbox");if(f){return g.is(":checked");}return g.val();}else{return e;}}};(function(n){var b0=300;"use strict";n.fn.OpiePortfolioGallery=function(b,c){var d="linear",e={boxSelector:".o-box",innerWrapperSelector:".o-inner-wrapper",bigImageSelector:"img.o-big-image",thumbImageSelector:"img.o-thumb-image",extraInfoSelector:".o-extra-info",enlargeButtonSelector:".o-enlarge",maxBoxSize:195,loaderFadeInDuration:150,loaderFadeOutDuration:450,boxMovementDuration:b0,delayIncrease:0,delayStart:0,maxDelay:0,scrollingAid:H,boxPositionEasing:d,extraInfoOpenEasing:d,extraInfoCloseEasing:d,boxOpenEasing:d,boxCloseEasing:d,boxOpenDuration:b0,boxCloseDuration:b0,filterNavSelector:l,dontResizeThumbs:l,useCentering:l,userCSS3Accelerate:H,showMore:12},g=new Opts(n.extend(e,b),n),f;this.each(function(){f=new n.OpiePortfolioGallery(g,n(this),arguments);if(b==="initCSS3"){IS.initCSS3.apply(f,c);}else{f.init();}});return this;};n.OpiePortfolioGallery=function(j,E,H0){var w0=100,z0="inMotion",y0="o-hidden",x0="bigImageSelector",j0="src",a0=".o-hidden",A0="delayIncrease",B0="boxSelector",q=this,s=E.find(j.string(B0)),N=E.find(j.string("innerWrapperSelector")),V=j.number("maxBoxSize"),p=0,z=0,l0=0,S=l,m0=0,W=j.bool("userCSS3Accelerate"),C0=j.number("boxCloseDuration"),D0=j.get("boxCloseEasing"),k0=j.number("boxMovementDuration"),n0=j.get("boxPositionEasing"),E0=j.number(A0),p0=j.get("boxOpenEasing"),o0=j.get("boxOpenDuration");this.init=function(){this.initCSS3();if(j.string("filterNavSelector")!==false){var e=n(j.string("filterNavSelector")),g=e.filter(".active");if(g.size()>0){S=g.getAttr("filter");}e.click(function(){e.removeClass("active");s.removeClass("doReduce doEnlarge");n(this).addClass("active");S=n(this).getAttr("filter");q.fillTiles(false,true);});}s.each(function(){var b=n(this);b.parseFilters();if(b.find(j.string("extraInfoSelector")).size()>0){b.find(j.string("bigImageSelector")).wrap('<div class="o-big-image-wrapper" />');b.find(".o-big-image-wrapper").append('<a href="#" class="o-enlarge closed"><span>Enlarge</span></a>');}b.setData("positionData",false);b.append('<div class="loader" />');});s.find(j.string("enlargeButtonSelector")).click(function(){var b=n(this),c=n(this).parents(j.string("boxSelector"));if(E.hasClass("inMotion")){return false;}if(c.hasClass("doEnlarge")){c.replaceClass("doEnlarge","doReduce");b.replaceClass("opened","closed");}else{b.replaceClass("closed","opened");c.replaceClass("doReduce","doEnlarge");}q.fillTiles(false,false);return false;});s.click(function(){if(E.hasClass("inMotion")){return false;}var b=n(this);if(b.hasClass("o-show-more")){q.showMore();}else{s.removeClass("doReduce doEnlarge");if(b.hasClass("active")){b.removeClass("active").addClass("preDeActive");}else{b.addClass("preactive");}q.loader(s.filter(".active").addClass("wasActive"),true);q.loader(b,true);q.fillTiles(true,false,true);return false;}});q.initSizes();var f=(function(){var d=0;return function(b,c){clearTimeout(d);d=setTimeout(b,c);};})(),o,t,x=n(window).resize(function(){var b=x.width();var c=x.height();if(o!=b||t!=c){f(function(){s.removeClass("active doEnlarge doReduce");s.find(j.string("bigImageSelector")).css("width","").css("height","");q.initSizes();},300);}o=b;t=c;});};this.initCSS3=function(){var b="s cubic-bezier(";if(W){if(Is.defined(window.location.protocol)&&(window.location.protocol=="file:"||window.location.protocol=="file")){console.log("OpiePortFolioScript : you cannot use userCSS3Accelerate in local machine, cause google chrome cannot access stylesheets");W=l;}}if(W&&n.support.transition){JsCss.init();var c="all "+(k0/1000)+b+CSS3Easings[n0]+")";JsCss.addRuleStyle(".opie-portfolio .o-box.moving",{"-webkit-transition":c,"-moz-transition":c,"-o-transition":c,"-ms-transition":c,"transition":c});var c="all "+(o0/1000)+b+CSS3Easings[p0]+")";JsCss.addRuleStyle(".opie-portfolio .o-box.opening",{"-webkit-transition":c,"-moz-transition":c,"-o-transition":c,"-ms-transition":c,"transition":c});}};this.initSizes=function(){s.setData("positionData",false);var b=E.outerWidth(true)-(E.outerWidth()-E.width());N.width(b);var c=b/V,d=Utils.roundNumber(c,2).toString().replace(/,/g,".").split("."),e=j.bool("dontResizeThumbs");if(e===false){if(Is.defined(d[1])&&d[1]<50){var g=Math.ceil(c);}else{var g=Math.floor(c);}}else{var g=d[0].toNumber();}var f=true;p=Math.floor((((100/g)/100)*b));if(e===false){while(f){if(p>V){g++;p=(((100/g)/100)*b);}else{f=false;}}}if(p>V){p=V;var o=(V*g);if(b>o&&j.bool("useCentering")===true){m0=b-o;N.width((b-m0));}}q.fillTiles(false,true);};this.loadThumbs=function(o){if(!Is.defined(o)){o=s.not(a0);}o.each(function(){var b="mouseOn",c="mouseOut",d=n(this),e=n(this).find(j.string("thumbImageSelector")),g=e.getAttr(j0),f=l;if(g){if(g==k){f=H;g=d.find(j.string(x0)).getAttr(j0);e.addClass(k);}e.unbind("load").load(function(){e.delAttr("src");if(f){if(this.naturalWidth>this.naturalHeight&&f){e.addClass("height");e.css("marginLeft",(this.width/2)*-1);}else{e.addClass("width");e.css("marginTop",(this.height/2)*-1);}}e.addClass("loaded");q.loader(d,false);}).attr("src",g);}d.hover(function(){n(this).replaceClass(c,b);},function(){n(this).replaceClass(b,c);});});};this.loader=function(b,c){var d="div.loader";if(c==H){b.find(d).each(function(){n(this).stop().fadeIn(j.number("loaderFadeInDuration"));});}else{b.find(d).each(function(){n(this).stop().stop().fadeOut(j.number("loaderFadeOutDuration"));});}};this.rePosImg=function(b,c,d,e){var g={};if(d>b){var f=Utils.calcNewImageSize(d,e,(b-(c-e)*2),k);d=f.w;e=f.h;g.width=d;g.height=e;}g.marginLeft=(b-d)/2;g.marginTop=(c-e)/2;n(this).css(g);};this.fillTiles=function(r0,q0,F0){if(E.hasClass("inMotion")){return false;}E.addClass("inMotion");z=0;var J=0,A=0,G0=0,K=N.innerWidth(),L=0,R=0,G=0,F=0,s0=s.filter(".preactive,.doEnlarge,.doReduce").size(),T=j.number("maxDelay");if(T==0){T=999999999;}var y=j.number("delayStart"),Y=function(c,d){var e=true;c.addClass("moving");for(var g=0;g<c.length;g++){var f=n(c[g]);if(!f.hasFilter(S)){f.addClass("filterOut");}else{f.removeClass("filtered");}if((!f.hasClass("preactive")&&!f.hasClass("doEnlarge")&&!f.hasClass("doReduce"))||f.hasClass("filterOut")){var o={width:p,height:p},t={};if(f.hasClass("filterOut")||f.hasClass("filtered")||f.hasClass("o-hidden")){if(!f.hasClass("filtered")){if(e==true){o.left=p.toNegative();e=false;}else{o.left=K+p;e=true;}o.top=p.toNegative();f.addClass("filtered");}}else{o.left=A;o.top=J;var x=A+p;if(x>K){J+=p;A=0;}x=A+p;e0=J+p;if(s0>0){var X=true;while(X){if((Is.between(A,L,(R-1))&&Is.between(J,G,(F-1)))||(Is.between((x-1),L,(R-1))&&Is.between((e0-1),G,(F-1)))){A=R;var x=A+p;if(x>K){J+=p;A=0;X=true;}else{X=false;}}else{X=false;}}}var x=A+p;if(x>K){J+=p;A=0;}o.left=A;o.top=J;A+=p;z=Math.max(z,(J+p));}if(f.hasClass("preDeActive")||f.hasClass("active")){t.duration=C0;t.easing=D0;}else{t.duration=k0;t.easing=n0;}t.complete=function(){var b=n(this);if(b.hasClass("active")||b.hasClass("o-show-more")||b.hasClass("preDeActive")){q.loader(b,false);}b.removeClass("preDeActive active moving");if(b.hasClass("last")){q.afterLastAnimation();}};var Q=f.getData("LastAnimCss");if(q0==true){f.setData("positionData",{left:o.left,top:o.top});}if(f.hasClass("o-hidden")){f.css(o);t.complete.bind(f)();}else{var c0=true;if(Q&&Q.left==o.left&&Q.top==o.top&&Q.height==o.height&&Q.width==o.width){if(f.hasClass("preDeActive")){debug(Q,o);}c0=false;}if(c0==true){if(W&&n.support.transition){f.css.eBind(f,[o]).delay(y);t.complete.eBind(f).delay((y+t.duration));}else{t.queue=false;f.delay(y).animate(o,t);}if(y<T){y+=E0;}}else{t.complete.bind(f)();}}f.setData("LastAnimCss",o);}else{f.removeClass("activated moving");}}};s.removeClass("filterOut");var U=(r0)?s.not(".filtered,.filterOut"):s;s.removeClass("last");U.last().addClass("last");var D=U.filter(".doEnlarge");if(D.size()>0){var m={},B={duration:j.number("extraInfoOpenDuration")};D.setData("beforeEnlargeHeight",D.height());var C=D.outerWidth(true),v=D.outerHeight(true)+D.find(j.string("extraInfoSelector")).outerHeight(true),t0=Math.ceil((v/p));v+=((t0*p)-v);m.height=v;var M=D.position();m.left=M.left;m.top=M.top;L=m.left;R=L+C;G=m.top;F=G+v;z=Math.max(z,F);B.easing=j.get("extraInfoCloseEasing");D.delay(y).animate(m,B);if(y<T){y+=j.number("delayIncrease");}if(!D.hasFilter(S)){D.addClass("filterOut");}D.setData("LastAnimCss",m);D=false;}var I=U.filter(".doReduce");if(I.size()>0){var m={},B={duration:j.number("extraInfoCloseDuration")},C=I.outerWidth(true),v=I.getData("beforeEnlargeHeight");m.height=v;var M=I.position();m.left=M.left;m.top=M.top;L=m.left;R=L+C;G=m.top;F=G+v;z=Math.max(z,F);B.easing=j.get("extraInfoOpenEasing");I.animate(m,B);if(!I.hasFilter(S)){I.addClass("filterOut");}I.setData("LastAnimCss",m);I=false;}var u=U.filter(".preactive");if(u.size()>0){u.addClass("opening");var m={},B={duration:o0},C=p*4,v=p*2;if(C>K){C=K;}m.width=C;m.height=v;var Z=u.getData("positionData");if(Z!==false&&u.hasClass("last")&&u.prevAll(j.string("boxSelector")+".wasActive").size()>0||u.nextAll(j.string("boxSelector")+".wasActive").size()>0){m.left=Z.left;m.top=Z.top;}else{var M=u.position();m.left=M.left;m.top=M.top;}s.removeClass("wasActive");var v0=m.left+C,e0=m.top+v;if(v0>K){var u0=K-C;m.left=u0;if(m.left<0){m.left=0;}}L=m.left;R=L+C;G=m.top;F=G+v;z=Math.max(z,F);if(j.bool("scrollingAid")){var d0=n(window).scrollTop(),i0=N.offset(),h0=n(window).height()+d0,g0=i0.top+F;if(g0>h0){n('html, body').animate({scrollTop:"+="+((g0-h0)+(v/2))},300);}var f0=i0.top+G;if(f0<d0){n('html, body').animate({scrollTop:f0-(v/2)},300);}}B.complete=function(){var b=n(this),c=b.find(j.string("bigImageSelector"));if(c.getAttr("src")){var d=c.getAttr("src");c.unbind("load").load(function(){c.setData("width",this.naturalWidth);c.setData("height",this.naturalHeight);q.rePosImg.call(c,C,v,this.naturalWidth,this.naturalHeight);b.replaceClass("preactive","active");c.delAttr("src");}).attr("src",d);}else{q.rePosImg.call(c,C,v,c.getData("width"),c.getData("height"));b.replaceClass("preactive","active");}b.removeClass("opening").find(j.string("enlargeButtonSelector")).removeClass("opened");q.loader(b,false);if(b.hasClass("last")){q.afterLastAnimation();}};B.easing=p0;if(W&&n.support.transition){u.css.eBind(u,[m]).delay(y);B.complete.eBind(u).delay((y+B.duration));}else{B.queue=false;u.delay(y).animate(m,B);}if(!u.hasFilter(S)){u.addClass("filterOut");}if(y<T){y+=j.number("delayIncrease");}Y(u.prevAll().reverse());y=0;Y(u.nextAll(),true);u.setData("LastAnimCss",m);u=false;}else{Y(U);}q.fixPortSize(false);};this.showMore=function(){var b=j.number("showMore");if(!b){b=1;}var c=s.filter(a0).slice(0,b).removeClass(y0);q.fillTiles(l,H);};this.afterLastAnimation=function(){E.removeClass(z0);window.setTimeout(q.loadThumbs,w0);q.fixPortSize(H);if(s.filter(a0).size()<=0){s.filter(".o-show-more").hide();}};this.fixPortSize=function(b){var c=N.position().top+N.innerHeight();if(z>c){var d="+="+(z-c);}else{var d="-="+(c-z);}if(b==l&&l0>z){return l;}N.stop().animate({"height":d},"fast");l0=z;};};})(jQuery);
